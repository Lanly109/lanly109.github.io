<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>滚榜程序Resolver源码阅读 | Lanlyの小窝</title><meta name="author" content="Lanly"><meta name="copyright" content="Lanly"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="太难了.jpg">
<meta property="og:type" content="article">
<meta property="og:title" content="滚榜程序Resolver源码阅读">
<meta property="og:url" content="http://blog.lanly.vip/posts/7b2538bb.html">
<meta property="og:site_name" content="Lanlyの小窝">
<meta property="og:description" content="太难了.jpg">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://blog.lanly.vip/img/chino/vec/chino4.jpg">
<meta property="article:published_time" content="2022-05-01T12:00:00.000Z">
<meta property="article:modified_time" content="2025-08-19T07:22:39.126Z">
<meta property="article:author" content="Lanly">
<meta property="article:tag" content="ICPC_tools">
<meta property="article:tag" content="resolver">
<meta property="article:tag" content="滚榜">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://blog.lanly.vip/img/chino/vec/chino4.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://blog.lanly.vip/posts/7b2538bb.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '滚榜程序Resolver源码阅读',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-08-19 15:22:39'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/var.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/universe.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/menuicon.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/essay.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/home_essay_bar.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="Lanlyの小窝" type="application/atom+xml">
</head><body><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = 'hidden';
    document.getElementById('loading-box').classList.remove("loaded")
  }
}

preloader.initLoading()
window.addEventListener('load',()=> { preloader.endLoading() })

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><script async="async" data-pjax="data-pjax" src="/js/WaterRipple.js"></script><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">18</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">35</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw menuicon icon-yunkongjian"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw menuicon icon-yuedu"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw menuicon icon-fazhanlicheng"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw menuicon icon-zhuti"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw menuicon icon-wenjianguanli"></i><span> 归档</span></a></li><li><a class="site-page child" href="/charts/"><i class="fa-fw menuicon icon-yundongjiankang"></i><span> 统计</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw menuicon icon-gaodeditu"></i><span> 导航</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw menuicon icon-shenghuofuwu"></i><span> 关于</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw menuicon icon-wanjijiqiao"></i><span> 娱乐</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/gallery/"><i class="fa-fw menuicon icon-lunbotu"></i><span> 画廊</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/chino/vec/chino4.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Lanlyの小窝"><span class="site-name">Lanlyの小窝</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-search fa-fw"></i></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw menuicon icon-yunkongjian"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw menuicon icon-yuedu"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw menuicon icon-fazhanlicheng"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw menuicon icon-zhuti"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw menuicon icon-wenjianguanli"></i><span> 归档</span></a></li><li><a class="site-page child" href="/charts/"><i class="fa-fw menuicon icon-yundongjiankang"></i><span> 统计</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw menuicon icon-gaodeditu"></i><span> 导航</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw menuicon icon-shenghuofuwu"></i><span> 关于</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw menuicon icon-wanjijiqiao"></i><span> 娱乐</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/gallery/"><i class="fa-fw menuicon icon-lunbotu"></i><span> 画廊</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">滚榜程序Resolver源码阅读</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-05-01T12:00:00.000Z" title="发表于 2022-05-01 20:00:00">2022-05-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-08-19T07:22:39.126Z" title="更新于 2025-08-19 15:22:39">2025-08-19</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/">源码阅读</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">6.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>37分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="滚榜程序Resolver源码阅读"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>
<p>本文简单记录下阅读icpc resolver源码的经历<br />
因为在resolver的说明文档里所说的支持CDP的格式，其链接已经404了，在2.1版本试出来的格式又不支持，在网上搜寻他人使用Resolver的经验无果后迫不得已尝试阅读resolver的源码，以期待找出其支持的CDP格式。</p>
</blockquote>
<p>从<a href="https://tools.icpc.global/docs/Resolver.pdf" rel="external nofollow noreferrer">Resolver的文档</a>可以得知，Resolver支持两种形式的滚榜数据：以CDS为数据源的通过网络方式获取的，和以CDP为数据源的通过本地方式获取的。由于颁奖典礼的地方经常没有网络，而滚榜时也想加入队伍照片的展示，因此采用CDP格式是比较好的。</p>
<h2 id="cdp格式"><a class="markdownIt-Anchor" href="#cdp格式"></a> CDP格式</h2>
<p>先说结果吧，Resolver2.4版本支持的CDP格式如下：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">.</span><br><span class="line">├── config              // 非必需</span><br><span class="line">│   ├── contest.yaml    // 从domjudge Import/export页面导出即可</span><br><span class="line">│   ├── groups.tsv      // 从domjudge Import/export页面导出即可</span><br><span class="line">│   ├── problemset.yaml</span><br><span class="line">│   └── teams.tsv       // 从domjudge Import/export页面导出即可</span><br><span class="line">├── contest</span><br><span class="line">│   ├── banner.png      // resolver无用，但在cds放置于此就可显示banner</span><br><span class="line">│   └── logo.png        // resolver主页面的图片&amp;无照片队伍的默认照片</span><br><span class="line">├── events.xml          // 滚榜数据</span><br><span class="line">├── <span class="built_in">groups</span>              // Categories照片，但在resolver似乎没起到作用</span><br><span class="line">│   └── 3               // Categories的<span class="built_in">id</span></span><br><span class="line">│       └── logo.png</span><br><span class="line">├── organizations       // Affiliations照片，只要某Affiliations的队伍有logo，其他同Affiliations的队伍就都是该logo</span><br><span class="line">│   ├── 3000            // 该Affiliations所对应的任一队伍的<span class="built_in">id</span></span><br><span class="line">│   │   └── logo.png</span><br><span class="line">│   ├── 3001</span><br><span class="line">│   │   └── logo.png</span><br><span class="line">│   ├── 3012</span><br><span class="line">│   │   └── logo.png</span><br><span class="line">│   ├── 3017</span><br><span class="line">│   │   ├── country_flag.png    // 照源码里是这样放置的，但在resolver似乎没起到作用</span><br><span class="line">│   │   └── logo.png</span><br><span class="line">│   └── 3187</span><br><span class="line">│       └── logo.png</span><br><span class="line">└── teams               // 队伍照片</span><br><span class="line">    ├── 3000            // 队伍的<span class="built_in">id</span></span><br><span class="line">    │   └── photo.png   // 照片名字固定是photo</span><br><span class="line">    ├── 3001</span><br><span class="line">    │   └── photo.png</span><br><span class="line">    ├── 3009</span><br><span class="line">    │   └── photo.png</span><br><span class="line">    └── 3010</span><br><span class="line">        └── photo.png</span><br></pre></td></tr></table></figure>
<p>其中<code>problemset.yaml</code>格式如下：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">problems:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">letter:</span>     <span class="string">A</span></span><br><span class="line">    <span class="attr">short-name:</span> <span class="string">A</span></span><br><span class="line">    <span class="attr">color:</span>      <span class="string">yellow</span></span><br><span class="line">    <span class="attr">rgb:</span>        <span class="string">&#x27;#ffff00&#x27;</span></span><br><span class="line">  </span><br><span class="line">  <span class="bullet">-</span> <span class="attr">letter:</span>     <span class="string">B</span></span><br><span class="line">    <span class="attr">short-name:</span> <span class="string">B</span></span><br><span class="line">    <span class="attr">color:</span>      <span class="string">red</span></span><br><span class="line">    <span class="attr">rgb:</span>        <span class="string">&#x27;#ff0000&#x27;</span></span><br><span class="line">  </span><br><span class="line">  <span class="bullet">-</span> <span class="attr">letter:</span>     <span class="string">C</span></span><br><span class="line">    <span class="attr">short-name:</span> <span class="string">C</span></span><br><span class="line">    <span class="attr">color:</span>      <span class="string">green</span></span><br><span class="line">    <span class="attr">rgb:</span>        <span class="string">&#x27;#00ff00&#x27;</span></span><br></pre></td></tr></table></figure>
<p>该文件非必需。需有该文件，请务必确保其<code>short-name</code>为题号，因为<code>resolver</code>的一血奖’first-to-solve-A’中的<code>A</code>与该<code>short-name</code>对应，而不是与<code>letter</code>对应。</p>
<hr />
<p>Resolver 2.1版本的CDP格式如下：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">.</span><br><span class="line">├── config          // 非必需</span><br><span class="line">│   ├── contest.yaml</span><br><span class="line">│   ├── groups.tsv</span><br><span class="line">│   ├── problemset.yaml</span><br><span class="line">│   └── teams.tsv</span><br><span class="line">├── events.xml      // 滚榜数据，其与2.4版少了个&lt;penalty&gt;属性，2.4无此属性直接报ERROR（而2.1没事</span><br><span class="line">└── images</span><br><span class="line">    ├── logo        // Affiliations的logo，数字为属于该Affiliations的任意队伍的<span class="built_in">id</span></span><br><span class="line">    │   └── 3001.png</span><br><span class="line">    └── team        // 队伍照片</span><br><span class="line">        ├── 3001.jpg    // 数字为队伍的<span class="built_in">id</span></span><br><span class="line">        ├── 3002.jpg</span><br><span class="line">        ├── 3003.jpg</span><br><span class="line">        ├── 3004.jpg</span><br><span class="line">        └── 3005.jpg</span><br></pre></td></tr></table></figure>
<p>其中滚榜数据<code>events.xml</code>的生成脚本可以用这个：<a href="https://github.com/Lanly109/icpc-resolver-from-domjudge" rel="external nofollow noreferrer">https://github.com/Lanly109/icpc-resolver-from-domjudge</a>。</p>
<h2 id="源码阅读"><a class="markdownIt-Anchor" href="#源码阅读"></a> 源码阅读</h2>
<h3 id="帮助"><a class="markdownIt-Anchor" href="#帮助"></a> 帮助</h3>
<p>帮助文案就在比较显而易见的地方：<code>Resolver/src/org/icpc/tools/resolver/Resolver.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">showHelp</span><span class="params">()</span> &#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;Usage: resolver.bat/sh contestURL user password [options]&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;   or: resolver.bat/sh contestPath [options]&quot;</span>);</span><br><span class="line">		System.out.println();</span><br><span class="line">		System.out.println(<span class="string">&quot;  General options:&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     --info&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         Show additional info to presenter client&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     --speed speedFactor&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         Resolution delay multiplier. e.g. 0.5 will be twice&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         as fast, 2 will be twice as slow&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     --singleStep startRow&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         Require a click for each step starting at a specific&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         row, or for entire contest if no row specified&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     --rowDisplayOffset numRows&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         Move the display up the screen by some number of&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         rows (default 4)&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     --display #&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         Use the specified display&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         1 = primary display, 2 = secondary display, etc.&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     --multi-display p@wxh&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         Stretch the presentation across multiple clients. Use \&quot;2@3x2\&quot;&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         to indicate this client is position 2 (top middle) in a 3x2 grid&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     --display_name template&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         Change the way teams are displayed using a template. Parameters:&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         &#123;team.display_name), &#123;team.name), &#123;org.formal_name&#125;, and &#123;org.name&#125;&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     --groups&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         Resolve only the groups in the given regex pattern for ids&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         If multiple groups are given, each is resolved separately&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     --pause #&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         Start at the given pause #. Useful for testing/preview&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     --judgeQueue&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         Start the resolution using a judge queue. Must have at least one list award&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     --test&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         Test on an unfinished contest. Ignores (removes) all unjudged runs&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     --light&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         Use light mode&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     --help&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         Shows this message&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     --version&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         Displays version information&quot;</span>);</span><br><span class="line">		System.out.println();</span><br><span class="line">		System.out.println(<span class="string">&quot;  Client options:&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     --presenter&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         connect to a CDS and control it&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     --client&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         connect to a CDS in slave (view-only) mode&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     --side&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         same as --client, but displays logos suitable for&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         a lower resolution/side display&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     --team&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         same as --client, but displays minimal content, e.g.&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;         to display on all team machines&quot;</span>);</span><br><span class="line"></span><br><span class="line">		System.out.println();</span><br><span class="line">		System.out.println(<span class="string">&quot;  Keyboard shortcuts:&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     Ctrl-Q - Quit&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     r      - Rewind&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     0      - Restart (jump to beginning)&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     2      - Fast forward (jump one step without delays)&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     1      - Fast rewind (jump one step back without delays)&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     +/up   - Speed up (reduce resolution delay)&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     -/down - Slow down (increase resolution delay)&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     j      - Reset resolution speed&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     p      - Pause/unpause scrolling&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;     i      - Toggle additional info&quot;</span>);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>上面提到了个选项judgeQueue，但我运行时加上这个参数似乎没什么效果，我以为是像在<a href="https://www.bilibili.com/video/BV15b411u7z6?p=2&amp;t=7702" rel="external nofollow noreferrer">2018 ICPC World Final</a>滚榜前展示的那个各队提交的通过情况judge queue一览。可能是我姿势不对。</p>
<h3 id="xml文件读取"><a class="markdownIt-Anchor" href="#xml文件读取"></a> xml文件读取</h3>
<p>其代码位于<code>ContestModel/src/org/icpc/tools/contest/model/feed/XMLFeedParser.java</code></p>
<p>上述<code>events.xml</code>可以参照该源码所给定的格式编写。</p>
<p>从第179行<code>protected void createContestObject(Contest contest, String name, List&lt;Property&gt; list) </code>处可以看到它对各属性进行解析。</p>
<p><code>xml</code>整体结构如下：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">contest</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">info</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">info</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">problem</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">problem</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">region</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">region</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">team</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">team</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">judgement</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">judgement</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">run</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">run</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">award</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">award</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">finalized</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">finalized</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">contest</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="contest-info"><a class="markdownIt-Anchor" href="#contest-info"></a> contest INFO</h4>
<p><code>info</code>的结构如下</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">info</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">contest-id</span>&gt;</span>4<span class="tag">&lt;/<span class="name">contest-id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Contest Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">short-title</span>&gt;</span>Contest Short Name<span class="tag">&lt;/<span class="name">short-title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">length</span>&gt;</span>4:00:00.000<span class="tag">&lt;/<span class="name">length</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scoreboard-freeze-length</span>&gt;</span>1:00:00.000<span class="tag">&lt;/<span class="name">scoreboard-freeze-length</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">starttime</span>&gt;</span>1650686700.0<span class="tag">&lt;/<span class="name">starttime</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">penalty</span>&gt;</span>20<span class="tag">&lt;/<span class="name">penalty</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">info</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>对应源码如下</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (INFO.equals(name)) &#123;</span><br><span class="line">    <span class="type">Info</span> <span class="variable">info</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Info</span>();</span><br><span class="line">    <span class="keyword">for</span> (Property p : list) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;contest-id&quot;</span>.equals(p.name))</span><br><span class="line">            add(info, ID, p.value);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;title&quot;</span>.equals(p.name))</span><br><span class="line">            add(info, <span class="string">&quot;formal_name&quot;</span>, p.value);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;short-title&quot;</span>.equals(p.name))</span><br><span class="line">            add(info, <span class="string">&quot;name&quot;</span>, p.value);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;starttime&quot;</span>.equals(p.name)) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">double</span> <span class="variable">d</span> <span class="operator">=</span> Double.parseDouble(p.value);</span><br><span class="line">                add(info, <span class="string">&quot;start_time&quot;</span>, Timestamp.format((<span class="type">long</span>) (d * <span class="number">1000.0</span>)));</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                <span class="comment">// ignore</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;length&quot;</span>.equals(p.name))</span><br><span class="line">            add(info, <span class="string">&quot;duration&quot;</span>, p.value);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;scoreboard-freeze-length&quot;</span>.equals(p.name))</span><br><span class="line">            add(info, <span class="string">&quot;scoreboard_freeze_duration&quot;</span>, p.value);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;penalty&quot;</span>.equals(p.name))</span><br><span class="line">            add(info, <span class="string">&quot;penalty_time&quot;</span>, p.value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (info.getId() == <span class="literal">null</span>)</span><br><span class="line">        add(info, ID, <span class="string">&quot;id-&quot;</span> + Math.random());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (info.getName() == <span class="literal">null</span>)</span><br><span class="line">        add(info, <span class="string">&quot;name&quot;</span>, info.getActualFormalName());</span><br><span class="line"></span><br><span class="line">    contest.add(info);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="problem"><a class="markdownIt-Anchor" href="#problem"></a> Problem</h4>
<p><code>problem</code>结构如下</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">problem</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>1<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>A<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>Problem_Name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">problem</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>对应源码如下</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">else</span> <span class="keyword">if</span> (PROBLEM.equals(name)) &#123;</span><br><span class="line">    <span class="type">Problem</span> <span class="variable">problem</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Problem</span>();</span><br><span class="line">    <span class="keyword">for</span> (Property p : list) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ID.equals(p.name)) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                add(problem, <span class="string">&quot;ordinal&quot;</span>, (Integer.parseInt(p.value) - <span class="number">1</span>) + <span class="string">&quot;&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                add(problem, <span class="string">&quot;ordinal&quot;</span>, p.value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (LABEL.equals(p.name))</span><br><span class="line">            add(problem, LABEL, p.value);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (LETTER.equals(p.name))</span><br><span class="line">            add(problem, LABEL, p.value);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (NAME.equals(p.name))</span><br><span class="line">            add(problem, NAME, p.value);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;color&quot;</span>.equals(p.name))</span><br><span class="line">            add(problem, <span class="string">&quot;color&quot;</span>, p.value);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;rgb&quot;</span>.equals(p.name))</span><br><span class="line">            add(problem, <span class="string">&quot;rgb&quot;</span>, p.value);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;test_data_count&quot;</span>.equals(p.name))</span><br><span class="line">            add(problem, <span class="string">&quot;test_data_count&quot;</span>, p.value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// find a problem with matching ordinal</span></span><br><span class="line">    IProblem[] probs = contest.getProblems();</span><br><span class="line">    <span class="keyword">for</span> (IProblem p : probs) &#123;</span><br><span class="line">        <span class="keyword">if</span> (p.getOrdinal() == problem.getOrdinal()) &#123;</span><br><span class="line">            add(problem, ID, p.getId());</span><br><span class="line">            <span class="keyword">if</span> (problem.getLabel() == <span class="literal">null</span>)</span><br><span class="line">                add(problem, LABEL, p.getLabel());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (problem.getId() == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// assume ordinal is an index</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// if no id, assume ordinal A = 0, B = 1, etc.</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> problem.getOrdinal();</span><br><span class="line">            <span class="keyword">if</span> (i &gt;= <span class="number">0</span> &amp;&amp; i &lt; LETTERS.length()) &#123;</span><br><span class="line">                add(problem, ID, LETTERS.charAt(i) + <span class="string">&quot;&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span> (problem.getLabel() == <span class="literal">null</span>)</span><br><span class="line">                    add(problem, LABEL, LETTERS.charAt(i) + <span class="string">&quot;&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// ignore</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// last attempt: if no label, use the id</span></span><br><span class="line">    <span class="keyword">if</span> (problem.getLabel() == <span class="literal">null</span>)</span><br><span class="line">        add(problem, LABEL, problem.getId());</span><br><span class="line"></span><br><span class="line">    contest.add(problem);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>它会和<code>problemset.yaml</code>读取到的<code>problem</code>进行对应，对应方式是就是出现序号<code>id</code>。</p>
<h4 id="regision"><a class="markdownIt-Anchor" href="#regision"></a> regision</h4>
<p><code>regision</code>即<code>group</code>即<code>category</code>，其结构如下</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">region</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">external-id</span>&gt;</span>3<span class="tag">&lt;/<span class="name">external-id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>Participants<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">region</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>对应源码如下</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (REGION.equals(name)) &#123;</span><br><span class="line">    <span class="type">Group</span> <span class="variable">group</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Group</span>();</span><br><span class="line">    <span class="keyword">for</span> (Property p : list) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;external-id&quot;</span>.equals(p.name)) &#123;</span><br><span class="line">            add(group, ICPC_ID, p.value);</span><br><span class="line">            add(group, ID, p.value);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (NAME.equals(p.name))</span><br><span class="line">            add(group, NAME, p.value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    contest.add(group);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="team"><a class="markdownIt-Anchor" href="#team"></a> team</h4>
<p><code>team</code>的结构如下</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">team</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>3000<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">external-id</span>&gt;</span>3000<span class="tag">&lt;/<span class="name">external-id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>请问你今天要来点拿铁吗(Is_the_order_a_Honor)<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">university</span>&gt;</span>兔之镇大学<span class="tag">&lt;/<span class="name">university</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">university-short-name</span>&gt;</span>兔之镇大学<span class="tag">&lt;/<span class="name">university-short-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">region</span>&gt;</span>Girls<span class="tag">&lt;/<span class="name">region</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">team</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>对应源码如下</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">else</span> <span class="keyword">if</span> (TEAM.equals(name)) &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">instId</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">Organization</span> <span class="variable">org</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Organization</span>();</span><br><span class="line">    <span class="keyword">for</span> (Property p : list) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ID.equals(p.name)) &#123;</span><br><span class="line">            add(org, ID, p.value);</span><br><span class="line">            instId = p.value;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;university&quot;</span>.equals(p.name)) &#123;</span><br><span class="line">            add(org, <span class="string">&quot;formal_name&quot;</span>, p.value);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;university-short-name&quot;</span>.equals(p.name)) &#123;</span><br><span class="line">            add(org, <span class="string">&quot;name&quot;</span>, p.value);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;nationality&quot;</span>.equals(p.name)) &#123;</span><br><span class="line">            add(org, <span class="string">&quot;country&quot;</span>, p.value);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (org.getName() == <span class="literal">null</span>)</span><br><span class="line">        add(org, <span class="string">&quot;name&quot;</span>, org.getActualFormalName());</span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">exists</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (IOrganization org2 : contest.getOrganizations()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (org2.getActualFormalName().equals(org.getActualFormalName())) &#123;</span><br><span class="line">            exists = <span class="literal">true</span>;</span><br><span class="line">            instId = org2.getId();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (org.getName() == <span class="literal">null</span> || org.getName().isEmpty())</span><br><span class="line">        add(org, <span class="string">&quot;name&quot;</span>, org.getActualFormalName());</span><br><span class="line">    <span class="keyword">if</span> (!exists)</span><br><span class="line">        contest.add(org);</span><br><span class="line"></span><br><span class="line">    <span class="type">Team</span> <span class="variable">team</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Team</span>();</span><br><span class="line">    <span class="keyword">for</span> (Property p : list) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ID.equals(p.name)) &#123;</span><br><span class="line">            add(team, ID, p.value);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;external-id&quot;</span>.equals(p.name))</span><br><span class="line">            add(team, ICPC_ID, p.value);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (NAME.equals(p.name))</span><br><span class="line">            add(team, NAME, p.value);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;region&quot;</span>.equals(p.name)) &#123;</span><br><span class="line">            IGroup[] groups = contest.getGroups();</span><br><span class="line">            <span class="keyword">for</span> (IGroup g : groups) &#123;</span><br><span class="line">                <span class="keyword">if</span> (g.getName().equals(p.value))</span><br><span class="line">                    add(team, <span class="string">&quot;group_id&quot;</span>, g.getId());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    add(team, <span class="string">&quot;organization_id&quot;</span>, instId);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// if we already have a team name, let it stand</span></span><br><span class="line">    <span class="type">ITeam</span> <span class="variable">existing</span> <span class="operator">=</span> contest.getTeamById(team.getId());</span><br><span class="line">    <span class="keyword">if</span> (existing != <span class="literal">null</span> &amp;&amp; existing.getName() != <span class="literal">null</span>)</span><br><span class="line">        add(team, NAME, existing.getName());</span><br><span class="line"></span><br><span class="line">    contest.add(team);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上述<code>xml</code>结构里没有<code>nationality</code>字段，但源码会对该字段解析，因此<code>xml</code>也可以加上这个信息<s>只是似乎没用</s>。</p>
<h4 id="judgement"><a class="markdownIt-Anchor" href="#judgement"></a> judgement</h4>
<p><code>judgement</code>就是表示评测结果，其结构如下</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">judgement</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">acronym</span>&gt;</span>CE<span class="tag">&lt;/<span class="name">acronym</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">judgement</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>对应源码如下</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">else</span> <span class="keyword">if</span> (JUDGEMENT.equals(name)) &#123;</span><br><span class="line">    <span class="type">JudgementType</span> <span class="variable">type</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JudgementType</span>();</span><br><span class="line">    <span class="keyword">for</span> (Property p : list) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;acronym&quot;</span>.equals(p.name)) &#123;</span><br><span class="line">            add(type, ID, p.value);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (NAME.equals(p.name)) &#123;</span><br><span class="line">            add(type, NAME, p.value);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;penalty&quot;</span>.equals(p.name)) &#123;</span><br><span class="line">            add(type, <span class="string">&quot;penalty&quot;</span>, p.value);</span><br><span class="line">            inferJudgementTypes = <span class="literal">false</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;solved&quot;</span>.equals(p.name)) &#123;</span><br><span class="line">            add(type, <span class="string">&quot;solved&quot;</span>, p.value);</span><br><span class="line">            inferJudgementTypes = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    contest.add(type);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>penalty</code>一般默认都是20分钟，<code>solved</code>字段没试过用来干嘛的，可能是表示另一种同样表示过题的状态？</p>
<h4 id="run"><a class="markdownIt-Anchor" href="#run"></a> run</h4>
<p>一份<code>run</code>就是一次选手代码提交的信息，其<code>xml</code>结构如下</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">run</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>1906<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">problem</span>&gt;</span>1<span class="tag">&lt;/<span class="name">problem</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">team</span>&gt;</span>3021<span class="tag">&lt;/<span class="name">team</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">judged</span>&gt;</span>true<span class="tag">&lt;/<span class="name">judged</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span>&gt;</span>WA<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">solved</span>&gt;</span>false<span class="tag">&lt;/<span class="name">solved</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">penalty</span>&gt;</span>true<span class="tag">&lt;/<span class="name">penalty</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">time</span>&gt;</span>286.296<span class="tag">&lt;/<span class="name">time</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">run</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>对应源码如下</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (RUN.equals(name)) &#123;</span><br><span class="line">    <span class="type">Submission</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Submission</span>();</span><br><span class="line">    <span class="keyword">for</span> (Property p : list) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ID.equals(p.name)) &#123;</span><br><span class="line">            add(s, ID, p.value);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;language&quot;</span>.equals(p.name)) &#123;</span><br><span class="line">            ILanguage[] langs = contest.getLanguages();</span><br><span class="line">            <span class="keyword">for</span> (ILanguage l : langs) &#123;</span><br><span class="line">                <span class="keyword">if</span> (l.getName().equals(p.value))</span><br><span class="line">                    add(s, <span class="string">&quot;language_id&quot;</span>, l.getId());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;problem&quot;</span>.equals(p.name)) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">pId</span> <span class="operator">=</span> p.value;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                pId = (Integer.parseInt(pId) - <span class="number">1</span>) + <span class="string">&quot;&quot;</span>;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                <span class="comment">//</span></span><br><span class="line">            &#125;</span><br><span class="line">            IProblem[] probs = contest.getProblems();</span><br><span class="line">            <span class="keyword">for</span> (IProblem pp : probs) &#123;</span><br><span class="line">                <span class="keyword">if</span> (pId.equals(pp.getOrdinal() + <span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">                    pId = pp.getId();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            add(s, <span class="string">&quot;problem_id&quot;</span>, pId);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;team&quot;</span>.equals(p.name)) &#123;</span><br><span class="line">            add(s, <span class="string">&quot;team_id&quot;</span>, p.value);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (TIME.equals(p.name)) &#123;</span><br><span class="line">            add(s, CONTEST_TIME, RelativeTime.format(RelativeTime.parseOld(p.value)));</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (TIMESTAMP.equals(p.name)) &#123;</span><br><span class="line">            add(s, TIME, Timestamp.format(Timestamp.parseOld(p.value)));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// don&#x27;t change submission time</span></span><br><span class="line">    <span class="type">ISubmission</span> <span class="variable">oldS</span> <span class="operator">=</span> contest.getSubmissionById(s.getId());</span><br><span class="line">    <span class="keyword">if</span> (oldS != <span class="literal">null</span>)</span><br><span class="line">        add(s, TIME, Timestamp.format(oldS.getTime()));</span><br><span class="line"></span><br><span class="line">    checkContestState(contest, s.getContestTime());</span><br><span class="line">    contest.add(s);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Property pp : list) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;judged&quot;</span>.equals(pp.name) &amp;&amp; <span class="string">&quot;true&quot;</span>.equalsIgnoreCase(pp.value)) &#123;</span><br><span class="line">            <span class="type">Judgement</span> <span class="variable">sj</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Judgement</span>();</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">solved</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">penalty</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">            <span class="type">IJudgementType</span> <span class="variable">type</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">for</span> (Property p : list) &#123;</span><br><span class="line">                <span class="keyword">if</span> (ID.equals(p.name)) &#123;</span><br><span class="line">                    add(sj, ID, p.value);</span><br><span class="line">                    add(sj, <span class="string">&quot;submission_id&quot;</span>, p.value);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (TIME.equals(p.name)) &#123;</span><br><span class="line">                    add(sj, START_CONTEST_TIME, RelativeTime.format(RelativeTime.parseOld(p.value)));</span><br><span class="line">                    add(sj, END_CONTEST_TIME, RelativeTime.format(RelativeTime.parseOld(p.value)));</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (TIMESTAMP.equals(p.name)) &#123;</span><br><span class="line">                    add(sj, START_TIME, Timestamp.format(Timestamp.parseOld(p.value)));</span><br><span class="line">                    add(sj, END_TIME, Timestamp.format(Timestamp.parseOld(p.value)));</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;result&quot;</span>.equals(p.name)) &#123;</span><br><span class="line">                    add(sj, <span class="string">&quot;judgement_type_id&quot;</span>, p.value);</span><br><span class="line">                    type = contest.getJudgementTypeById(p.value);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;solved&quot;</span>.equals(p.name)) &#123;</span><br><span class="line">                    solved = <span class="string">&quot;true&quot;</span>.equalsIgnoreCase(p.value);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;penalty&quot;</span>.equals(p.name)) &#123;</span><br><span class="line">                    penalty = <span class="string">&quot;true&quot;</span>.equalsIgnoreCase(p.value);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (inferJudgementTypes &amp;&amp; type != <span class="literal">null</span> &amp;&amp; (solved || penalty)) &#123;</span><br><span class="line">                <span class="type">boolean</span> <span class="variable">update</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">                <span class="type">JudgementType</span> <span class="variable">typeMatch</span> <span class="operator">=</span> (JudgementType) ((JudgementType) type).clone();</span><br><span class="line">                <span class="keyword">if</span> (solved &amp;&amp; !typeMatch.isSolved()) &#123;</span><br><span class="line">                    add(typeMatch, <span class="string">&quot;solved&quot;</span>, <span class="string">&quot;true&quot;</span>);</span><br><span class="line">                    update = <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (penalty &amp;&amp; !typeMatch.isPenalty()) &#123;</span><br><span class="line">                    add(typeMatch, <span class="string">&quot;penalty&quot;</span>, <span class="string">&quot;true&quot;</span>);</span><br><span class="line">                    update = <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (update)</span><br><span class="line">                    contest.add(typeMatch);</span><br><span class="line">            &#125;</span><br><span class="line">            checkContestState(contest, sj.getStartContestTime());</span><br><span class="line">            checkContestState(contest, sj.getEndContestTime());</span><br><span class="line">            contest.add(sj);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这部分没多大细看，应该逻辑也不复杂。</p>
<h4 id="award"><a class="markdownIt-Anchor" href="#award"></a> award</h4>
<p><code>award</code>表示颁发的获奖信息，其<code>xml</code>结构如下</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">award</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>gold-medal<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">citation</span>&gt;</span>Gold Medalist<span class="tag">&lt;/<span class="name">citation</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">show</span>&gt;</span>true<span class="tag">&lt;/<span class="name">show</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">teamId</span>&gt;</span>3167<span class="tag">&lt;/<span class="name">teamId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">teamId</span>&gt;</span>3204<span class="tag">&lt;/<span class="name">teamId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">teamId</span>&gt;</span>3036<span class="tag">&lt;/<span class="name">teamId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">teamId</span>&gt;</span>3009<span class="tag">&lt;/<span class="name">teamId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">award</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>注意同类型的获奖的所有队伍都必须写在同一个<code>award</code>中，否则会覆盖。比如前一个<code>award</code>是<code>gold-medal</code>，后一个<code>award</code>也是<code>gold-medal</code>，那么最终颁给<code>gold-medal</code>的队伍是后一个<code>award</code>对应的队伍。</p>
<p>对应源码如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (AWARD.equals(name)) &#123;</span><br><span class="line">    <span class="type">Award</span> <span class="variable">award</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Award</span>();</span><br><span class="line">    List&lt;String&gt; teamIds = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (Property p : list) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;teamId&quot;</span>.equals(p.name))</span><br><span class="line">            teamIds.add(p.value);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (ID.equals(p.name))</span><br><span class="line">            add(award, ID, p.value);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;citation&quot;</span>.equals(p.name))</span><br><span class="line">            add(award, p.name, p.value);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;show&quot;</span>.equals(p.name))</span><br><span class="line">            add(award, <span class="string">&quot;show&quot;</span>, p.value);</span><br><span class="line">    &#125;</span><br><span class="line">    award.add(<span class="string">&quot;team_ids&quot;</span>, <span class="string">&quot;[\&quot;&quot;</span> + String.join(<span class="string">&quot;\&quot;,\&quot;&quot;</span>, teamIds) + <span class="string">&quot;\&quot;]&quot;</span>);</span><br><span class="line"></span><br><span class="line">    contest.add(award);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>id</code>是<code>resolver</code>定义好的一些获奖类型，<code>citation</code>是在滚榜程序显示的文字。</p>
<h4 id="finalized"><a class="markdownIt-Anchor" href="#finalized"></a> finalized</h4>
<p><code>finalized</code>由于国内存在打星队伍等情况，一般就没用到了，其<code>xml</code>结构如下</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">finalized</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">last-gold</span>&gt;</span>0<span class="tag">&lt;/<span class="name">last-gold</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">last-silver</span>&gt;</span>0<span class="tag">&lt;/<span class="name">last-silver</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">last-bronze</span>&gt;</span>0<span class="tag">&lt;/<span class="name">last-bronze</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">timestamp</span>&gt;</span>0<span class="tag">&lt;/<span class="name">timestamp</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">finalized</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>对应源码如下</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (FINALIZED.equals(name)) &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">gold</span> <span class="operator">=</span> <span class="number">4</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">silver</span> <span class="operator">=</span> <span class="number">4</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">bronze</span> <span class="operator">=</span> <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">for</span> (Property p : list) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;last-gold&quot;</span>.equals(p.name))</span><br><span class="line">            gold = Integer.parseInt(p.value);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;last-silver&quot;</span>.equals(p.name))</span><br><span class="line">            silver = Integer.parseInt(p.value);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;last-bronze&quot;</span>.equals(p.name))</span><br><span class="line">            bronze = Integer.parseInt(p.value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// convert to actual numbers, not last</span></span><br><span class="line">    bronze -= silver;</span><br><span class="line">    silver -= gold;</span><br><span class="line"></span><br><span class="line">    <span class="type">State</span> <span class="variable">state</span> <span class="operator">=</span> (State) contest.getState();</span><br><span class="line">    <span class="type">Long</span> <span class="variable">startTime</span> <span class="operator">=</span> contest.getStartTime();</span><br><span class="line">    <span class="keyword">if</span> (state != <span class="literal">null</span> &amp;&amp; !state.isFinal() &amp;&amp; startTime != <span class="literal">null</span>) &#123; <span class="comment">// end the contest</span></span><br><span class="line">        state = (State) state.clone();</span><br><span class="line">        <span class="type">Long</span> <span class="variable">time</span> <span class="operator">=</span> startTime + contest.getDuration();</span><br><span class="line">        state.setEnded(time);</span><br><span class="line">        state.setThawed(time);</span><br><span class="line">        state.setFinalized(time);</span><br><span class="line">        contest.add(state);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// add awards</span></span><br><span class="line">        AwardUtil.createMedalAwards(contest, gold, silver, bronze);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// end of updates</span></span><br><span class="line">        state = (State) state.clone();</span><br><span class="line">        state.setEndOfUpdates(time);</span><br><span class="line">        contest.add(state);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// contest.add(f);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="其他字段"><a class="markdownIt-Anchor" href="#其他字段"></a> 其他字段</h4>
<p>除了上述字段之外，从源码中可以看到其实还有其他字段</p>
<h4 id="testcase"><a class="markdownIt-Anchor" href="#testcase"></a> testcase</h4>
<p>其源码如下</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (TESTCASE.equals(name)) &#123;</span><br><span class="line">    <span class="type">Run</span> <span class="variable">run</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Run</span>();</span><br><span class="line">    <span class="type">String</span> <span class="variable">i</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">n</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">runId</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">for</span> (Property p : list) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;i&quot;</span>.equals(p.name)) &#123;</span><br><span class="line">            i = p.value;</span><br><span class="line">            add(run, <span class="string">&quot;ordinal&quot;</span>, p.value);</span><br><span class="line">            <span class="comment">// add(run, &quot;i&quot;, p.value);</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;n&quot;</span>.equals(p.name)) &#123;</span><br><span class="line">            n = p.value;</span><br><span class="line">            <span class="comment">// add(run, &quot;n&quot;, p.value);</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;run-id&quot;</span>.equals(p.name)) &#123;</span><br><span class="line">            runId = p.value;</span><br><span class="line">            add(run, <span class="string">&quot;judgement_id&quot;</span>, p.value);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;judgement&quot;</span>.equals(p.name)) &#123;</span><br><span class="line">            add(run, <span class="string">&quot;judgement_type_id&quot;</span>, p.value);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (TIME.equals(p.name)) &#123;</span><br><span class="line">            add(run, CONTEST_TIME, RelativeTime.format(RelativeTime.parseOld(p.value)));</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (TIMESTAMP.equals(p.name)) &#123;</span><br><span class="line">            add(run, TIME, Timestamp.format(Timestamp.parseOld(p.value)));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    checkContestState(contest, run.getContestTime());</span><br><span class="line">    add(run, ID, runId + <span class="string">&quot;-&quot;</span> + i);</span><br><span class="line"></span><br><span class="line">    <span class="type">ISubmission</span> <span class="variable">s</span> <span class="operator">=</span> contest.getSubmissionById(runId);</span><br><span class="line">    <span class="keyword">if</span> (s != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="type">IProblem</span> <span class="variable">p</span> <span class="operator">=</span> contest.getProblemById(s.getProblemId());</span><br><span class="line">        <span class="type">int</span> <span class="variable">nn</span> <span class="operator">=</span> Integer.parseInt(n);</span><br><span class="line">        <span class="keyword">if</span> (p != <span class="literal">null</span> &amp;&amp; p.getTestDataCount() &lt; nn) &#123;</span><br><span class="line">            <span class="type">Problem</span> <span class="variable">pp</span> <span class="operator">=</span> (Problem) ((Problem) p).clone();</span><br><span class="line">            add(pp, <span class="string">&quot;test_data_count&quot;</span>, n);</span><br><span class="line">            contest.add(pp);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// make sure judgement exists before runs that refer to it</span></span><br><span class="line">    <span class="type">IJudgement</span> <span class="variable">j</span> <span class="operator">=</span> contest.getJudgementById(runId);</span><br><span class="line">    <span class="keyword">if</span> (j == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="type">Judgement</span> <span class="variable">sj</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Judgement</span>();</span><br><span class="line">        add(sj, <span class="string">&quot;id&quot;</span>, runId);</span><br><span class="line">        add(sj, <span class="string">&quot;submission_id&quot;</span>, runId);</span><br><span class="line"></span><br><span class="line">        <span class="type">ISubmission</span> <span class="variable">ss</span> <span class="operator">=</span> contest.getSubmissionById(runId);</span><br><span class="line">        <span class="keyword">if</span> (ss != <span class="literal">null</span>) &#123;</span><br><span class="line">            add(sj, START_CONTEST_TIME, RelativeTime.format(ss.getContestTime()));</span><br><span class="line">            add(sj, START_TIME, Timestamp.format(ss.getTime()));</span><br><span class="line">        &#125;</span><br><span class="line">        contest.add(sj);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    contest.add(run);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="clar"><a class="markdownIt-Anchor" href="#clar"></a> clar</h4>
<p>其源码如下</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (CLAR.equals(name)) &#123;</span><br><span class="line">    <span class="type">Clarification</span> <span class="variable">clar</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Clarification</span>();</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">id</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">question</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">answer</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">team</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">toAll</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (Property p : list) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ID.equals(p.name)) &#123;</span><br><span class="line">            id = p.value;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;team&quot;</span>.equals(p.name)) &#123;</span><br><span class="line">            team = p.value;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;problem&quot;</span>.equals(p.name)) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">pId</span> <span class="operator">=</span> p.value;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                pId = (Integer.parseInt(p.value) - <span class="number">1</span>) + <span class="string">&quot;&quot;</span>;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                <span class="comment">// ignore</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            IProblem[] probs = contest.getProblems();</span><br><span class="line">            <span class="keyword">for</span> (IProblem pr : probs)</span><br><span class="line">                <span class="keyword">if</span> ((pr.getOrdinal() + <span class="string">&quot;&quot;</span>).equals(pId))</span><br><span class="line">                    add(clar, <span class="string">&quot;problem_id&quot;</span>, pr.getId());</span><br><span class="line">            <span class="keyword">if</span> (clar.getProblemId() == <span class="literal">null</span>)</span><br><span class="line">                add(clar, <span class="string">&quot;problem_id&quot;</span>, pId);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;question&quot;</span>.equals(p.name)) &#123;</span><br><span class="line">            question = p.value;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;answer&quot;</span>.equals(p.name)) &#123;</span><br><span class="line">            answer = p.value;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;to-all&quot;</span>.equals(p.name)) &#123;</span><br><span class="line">            toAll = Boolean.valueOf(p.value);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (TIME.equals(p.name)) &#123;</span><br><span class="line">            add(clar, CONTEST_TIME, RelativeTime.format(RelativeTime.parseOld(p.value)));</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (TIMESTAMP.equals(p.name)) &#123;</span><br><span class="line">            add(clar, TIME, Timestamp.format(Timestamp.parseOld(p.value)));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (answer != <span class="literal">null</span> &amp;&amp; !answer.trim().isEmpty()) &#123;</span><br><span class="line">        add(clar, ID, id + <span class="string">&quot;-reply&quot;</span>);</span><br><span class="line">        add(clar, <span class="string">&quot;reply_to_id&quot;</span>, id);</span><br><span class="line">        add(clar, <span class="string">&quot;text&quot;</span>, answer);</span><br><span class="line">        <span class="keyword">if</span> (!toAll)</span><br><span class="line">            add(clar, <span class="string">&quot;to_team_id&quot;</span>, team);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        add(clar, ID, id);</span><br><span class="line">        add(clar, <span class="string">&quot;text&quot;</span>, question);</span><br><span class="line">        add(clar, <span class="string">&quot;from_team_id&quot;</span>, team);</span><br><span class="line">    &#125;</span><br><span class="line">    contest.add(clar);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="获奖类型"><a class="markdownIt-Anchor" href="#获奖类型"></a> 获奖类型</h3>
<p>获奖类型的定义在<code>ContestModel/src/org/icpc/tools/contest/model/IAward.java</code></p>
<p>共有以下十一种获奖类型</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">AwardType</span> <span class="variable">WINNER</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AwardType</span>(<span class="string">&quot;Winner&quot;</span>, <span class="string">&quot;winner&quot;</span>);</span><br><span class="line"><span class="type">AwardType</span> <span class="variable">RANK</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AwardType</span>(<span class="string">&quot;Rank&quot;</span>, <span class="string">&quot;rank-.*&quot;</span>);</span><br><span class="line"><span class="type">AwardType</span> <span class="variable">MEDAL</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AwardType</span>(<span class="string">&quot;Medal&quot;</span>, <span class="string">&quot;.*-medal&quot;</span>);</span><br><span class="line"><span class="type">AwardType</span> <span class="variable">FIRST_TO_SOLVE</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AwardType</span>(<span class="string">&quot;First to Solve&quot;</span>, <span class="string">&quot;first-to-solve-.*&quot;</span>);</span><br><span class="line"><span class="type">AwardType</span> <span class="variable">GROUP</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AwardType</span>(<span class="string">&quot;Group Winner&quot;</span>, <span class="string">&quot;group-winner-.*&quot;</span>);</span><br><span class="line"><span class="type">AwardType</span> <span class="variable">ORGANIZATION</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AwardType</span>(<span class="string">&quot;Organization Winner&quot;</span>, <span class="string">&quot;organization-winner-.*&quot;</span>);</span><br><span class="line"><span class="type">AwardType</span> <span class="variable">GROUP_HIGHLIGHT</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AwardType</span>(<span class="string">&quot;Group Highlight&quot;</span>, <span class="string">&quot;group-highlight-.*&quot;</span>);</span><br><span class="line"><span class="type">AwardType</span> <span class="variable">SOLVED</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AwardType</span>(<span class="string">&quot;Solved&quot;</span>, <span class="string">&quot;solved-.*&quot;</span>);</span><br><span class="line"><span class="type">AwardType</span> <span class="variable">TOP</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AwardType</span>(<span class="string">&quot;Top&quot;</span>, <span class="string">&quot;top-.*&quot;</span>);</span><br><span class="line"><span class="type">AwardType</span> <span class="variable">HONORS</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AwardType</span>(<span class="string">&quot;Honors&quot;</span>, <span class="string">&quot;honors-.*&quot;</span>);</span><br><span class="line"><span class="comment">// AwardType HONORABLE_MENTION = new AwardType(&quot;Honorable Mention&quot;, &quot;honorable-mention&quot;);</span></span><br><span class="line"><span class="type">AwardType</span> <span class="variable">OTHER</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AwardType</span>(<span class="string">&quot;Other&quot;</span>, <span class="string">&quot;.*&quot;</span>);</span><br><span class="line"></span><br><span class="line">AwardType[] KNOWN_TYPES = <span class="keyword">new</span> <span class="title class_">AwardType</span>[] &#123; WINNER, RANK, MEDAL, FIRST_TO_SOLVE, GROUP, ORGANIZATION,</span><br><span class="line">        GROUP_HIGHLIGHT, SOLVED, TOP, HONORS, OTHER &#125;;</span><br></pre></td></tr></table></figure>
<p><code>AwardType</code>第二个参数就是正则匹配规则。<s>打铁奖还被注释掉了</s></p>
<p>不同类型的获奖规则呈现在<code>resolver</code>上的话就是排序顺序和文字颜色和是否粗体的不同。</p>
<h3 id="yaml文件"><a class="markdownIt-Anchor" href="#yaml文件"></a> yaml文件</h3>
<p><code>yaml</code>读取的源代码在<code>ContestModel/src/org/icpc/tools/contest/model/internal/YamlParser.java</code></p>
<h4 id="contestyaml"><a class="markdownIt-Anchor" href="#contestyaml"></a> contest.yaml</h4>
<p>该文件可以直接从<code>domjudge</code>的<code>import/export</code>页面导出。</p>
<p>其源码如下</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">Info</span> <span class="variable">info</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Info</span>();</span><br><span class="line">    info.add(<span class="string">&quot;id&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (Object ob : map.keySet()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ob <span class="keyword">instanceof</span> String) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> (String) ob;</span><br><span class="line">            <span class="type">Object</span> <span class="variable">val</span> <span class="operator">=</span> map.get(key);</span><br><span class="line">            <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">if</span> (val != <span class="literal">null</span>)</span><br><span class="line">                value = val.toString();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="string">&quot;name&quot;</span>.equals(key) &amp;&amp; oldFormat)</span><br><span class="line">                    info.add(<span class="string">&quot;formal_name&quot;</span>, value);</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;short-name&quot;</span>.equals(key))</span><br><span class="line">                    info.add(<span class="string">&quot;name&quot;</span>, value);</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;length&quot;</span>.equals(key) || <span class="string">&quot;duration&quot;</span>.equals(key)) &#123;</span><br><span class="line">                    <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> RelativeTime.parse(value);</span><br><span class="line">                    <span class="keyword">if</span> (length &gt;= <span class="number">0</span>)</span><br><span class="line">                        info.add(<span class="string">&quot;duration&quot;</span>, RelativeTime.format(length));</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;scoreboard-freeze&quot;</span>.equals(key)) &#123;</span><br><span class="line">                    <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> RelativeTime.parse(value);</span><br><span class="line">                    <span class="type">int</span> <span class="variable">d</span> <span class="operator">=</span> info.getDuration();</span><br><span class="line">                    <span class="keyword">if</span> (length &gt;= <span class="number">0</span> &amp;&amp; d &gt; <span class="number">0</span>)</span><br><span class="line">                        info.add(<span class="string">&quot;scoreboard_freeze_duration&quot;</span>, RelativeTime.format(d / <span class="number">1000</span> - length));</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;scoreboard-freeze-length&quot;</span>.equals(key)) &#123;</span><br><span class="line">                    <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> RelativeTime.parse(value);</span><br><span class="line">                    <span class="keyword">if</span> (length &gt;= <span class="number">0</span>)</span><br><span class="line">                        info.add(<span class="string">&quot;scoreboard_freeze_duration&quot;</span>, RelativeTime.format(length));</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;penalty-time&quot;</span>.equals(key)) &#123;</span><br><span class="line">                    info.add(<span class="string">&quot;penalty_time&quot;</span>, value);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;start-time&quot;</span>.equals(key)) &#123;</span><br><span class="line">                    info.add(<span class="string">&quot;start_time&quot;</span>, value);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;banner&quot;</span>.equals(key)) &#123;</span><br><span class="line">                    info.setBanner(parseFileReferenceList((List&lt;?&gt;) val));</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;logo&quot;</span>.equals(key)) &#123;</span><br><span class="line">                    info.setLogo(parseFileReferenceList((List&lt;?&gt;) val));</span><br><span class="line">                &#125; <span class="keyword">else</span></span><br><span class="line">                    info.add(key, value);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">                Trace.trace(Trace.ERROR, <span class="string">&quot;Could not parse &quot;</span> + key + <span class="string">&quot;: &quot;</span> + value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>从源码可以看出来其实从<code>domjudge</code>导出的<code>contest.yaml</code>有很多字段是没必要的。</p>
<h4 id="problemsetyaml"><a class="markdownIt-Anchor" href="#problemsetyaml"></a> problemset.yaml</h4>
<p><code>problemset</code>就要自己编写了。其格式上面提到。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (Object o : list) &#123;</span><br><span class="line">    <span class="keyword">if</span> (o <span class="keyword">instanceof</span> Map&lt;?, ?&gt;) &#123;</span><br><span class="line">        Map&lt;?, ?&gt; map = (Map&lt;?, ?&gt;) o;</span><br><span class="line"></span><br><span class="line">        <span class="type">Problem</span> <span class="variable">problem</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Problem</span>();</span><br><span class="line">        problem.add(<span class="string">&quot;ordinal&quot;</span>, <span class="string">&quot;&quot;</span> + i);</span><br><span class="line">        i++;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Object ob : map.keySet()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (ob <span class="keyword">instanceof</span> String) &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> (String) ob;</span><br><span class="line">                <span class="type">Object</span> <span class="variable">val</span> <span class="operator">=</span> map.get(key);</span><br><span class="line">                <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">if</span> (val != <span class="literal">null</span>)</span><br><span class="line">                    value = val.toString();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (<span class="string">&quot;letter&quot;</span>.equals(key))</span><br><span class="line">                    problem.add(<span class="string">&quot;label&quot;</span>, value);</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;short-name&quot;</span>.equals(key)) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (problem.getId() == <span class="literal">null</span>)</span><br><span class="line">                        problem.add(<span class="string">&quot;id&quot;</span>, value);</span><br><span class="line">                    <span class="keyword">if</span> (problem.getName() == <span class="literal">null</span>)</span><br><span class="line">                        problem.add(<span class="string">&quot;name&quot;</span>, value);</span><br><span class="line">                &#125; <span class="keyword">else</span></span><br><span class="line">                    problem.add(key, value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (problem.getId() != <span class="literal">null</span> &amp;&amp; (problem.getTestDataCount() &lt;= <span class="number">0</span> || problem.getTimeLimit() &lt;= <span class="number">0</span>)) &#123;</span><br><span class="line">            <span class="type">File</span> <span class="variable">problemFolder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(f.getParentFile(), problem.getId());</span><br><span class="line">            <span class="keyword">if</span> (problemFolder.exists()) &#123;</span><br><span class="line">                addProblemTestDataCount(problemFolder, problem);</span><br><span class="line">                addProblemTimeLimit(problemFolder, problem);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    importProblem(problemFolder, problem);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    <span class="comment">// ignore for now</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        problems.add(problem);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>从源码可以看出，它是把<code>short-name</code>作为<code>problem</code>的<code>id</code>的。而在分析一血奖时，它会根据<code>first-to-solve-A</code>中的<code>A</code>和该<code>id</code>进行匹配，若未匹配到，则会报告无法解析一血奖。</p>
<p>分析（呈现）获奖的代码在<code>PresContest/src/org/icpc/tools/presentation/contest/internal/presentations/resolver/TeamAwardPresentation.java</code></p>
<p>在<code>402</code>行处，</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (IAward a : currentCache.awards) &#123;</span><br><span class="line">    <span class="keyword">if</span> (a.getAwardType() == IAward.FIRST_TO_SOLVE) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">pId</span> <span class="operator">=</span> a.getId().substring(patternLen);</span><br><span class="line">        <span class="type">IProblem</span> <span class="variable">p</span> <span class="operator">=</span> getContest().getProblemById(pId);</span><br><span class="line">        <span class="keyword">if</span> (p == <span class="literal">null</span>) &#123;</span><br><span class="line">            Trace.trace(Trace.WARNING, <span class="string">&quot;Could not consolidate FTS award: &quot;</span> + a.getId());</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        fts.add(p.getLabel());</span><br><span class="line">        <span class="keyword">if</span> (a.getDisplayMode() != <span class="literal">null</span>)</span><br><span class="line">            mode = a.getDisplayMode();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (a.getId().contains(<span class="string">&quot;solution&quot;</span>)) &#123;</span><br><span class="line">        hasSolutionAward = <span class="literal">true</span>;</span><br><span class="line">        list.add(a);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (a.getAwardType() == IAward.MEDAL)</span><br><span class="line">            hasMedal = <span class="literal">true</span>;</span><br><span class="line">        list.add(a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>若<code>pid</code>未找到则会报告<code>Could not consolidate FTS award</code>。</p>
<h3 id="资源路径"><a class="markdownIt-Anchor" href="#资源路径"></a> 资源路径</h3>
<p>资源路径相关的代码位于<code>ContestModel/src/org/icpc/tools/contest/model/feed/DiskContestSource.java</code></p>
<p>在<code>823</code>行的函数<code>protected FilePattern getLocalPattern(IContestObject.ContestType type, String id, String property)</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">protected</span> FilePattern <span class="title function_">getLocalPattern</span><span class="params">(IContestObject.ContestType type, String id, String property)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (type == ContestType.CONTEST) &#123;</span><br><span class="line">        <span class="keyword">if</span> (LOGO.equals(property))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FilePattern</span>(<span class="literal">null</span>, id, property, LOGO_EXTENSIONS);</span><br><span class="line">        <span class="keyword">if</span> (BANNER.equals(property))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FilePattern</span>(<span class="literal">null</span>, id, property, LOGO_EXTENSIONS);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type == ContestType.TEAM) &#123;</span><br><span class="line">        <span class="keyword">if</span> (PHOTO.equals(property))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FilePattern</span>(type, id, property, PHOTO_EXTENSIONS);</span><br><span class="line">        <span class="keyword">if</span> (VIDEO.equals(property))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FilePattern</span>(type, id, property, <span class="string">&quot;m2ts&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (BACKUP.equals(property))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FilePattern</span>(type, id, property, <span class="string">&quot;zip&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (KEY_LOG.equals(property))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FilePattern</span>(type, id, property, <span class="string">&quot;txt&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (TOOL_DATA.equals(property))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FilePattern</span>(type, id, property, <span class="string">&quot;txt&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type == ContestType.PERSON) &#123;</span><br><span class="line">        <span class="keyword">if</span> (PHOTO.equals(property))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FilePattern</span>(type, id, property, PHOTO_EXTENSIONS);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type == ContestType.ORGANIZATION) &#123;</span><br><span class="line">        <span class="keyword">if</span> (LOGO.equals(property))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FilePattern</span>(type, id, property, LOGO_EXTENSIONS);</span><br><span class="line">        <span class="keyword">if</span> (COUNTRY_FLAG.equals(property))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FilePattern</span>(type, id, property, LOGO_EXTENSIONS);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type == ContestType.SUBMISSION) &#123;</span><br><span class="line">        <span class="keyword">if</span> (FILES.equals(property))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FilePattern</span>(type, id, property, <span class="string">&quot;zip&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (REACTION.equals(property))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FilePattern</span>(type, id, property, <span class="string">&quot;m2ts&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type == ContestType.GROUP) &#123;</span><br><span class="line">        <span class="keyword">if</span> (LOGO.equals(property))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FilePattern</span>(type, id, property, LOGO_EXTENSIONS);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中<code>contestType</code>定义在<code>ContestModel/src/org/icpc/tools/contest/model/IContestObject.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">ContestType</span> &#123;</span><br><span class="line">		CONTEST, LANGUAGE, GROUP, ORGANIZATION, TEAM, STATE, RUN, SUBMISSION, JUDGEMENT, CLARIFICATION, AWARD, JUDGEMENT_TYPE, TEST_DATA, PROBLEM, PAUSE, TEAM_MEMBER, MAP_INFO, START_STATUS, COMMENTARY</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">String[] ContestTypeNames = <span class="keyword">new</span> <span class="title class_">String</span>[] &#123; <span class="string">&quot;contests&quot;</span>, <span class="string">&quot;languages&quot;</span>, <span class="string">&quot;groups&quot;</span>, <span class="string">&quot;organizations&quot;</span>, <span class="string">&quot;teams&quot;</span>, <span class="string">&quot;state&quot;</span>,</span><br><span class="line">        <span class="string">&quot;runs&quot;</span>, <span class="string">&quot;submissions&quot;</span>, <span class="string">&quot;judgements&quot;</span>, <span class="string">&quot;clarifications&quot;</span>, <span class="string">&quot;awards&quot;</span>, <span class="string">&quot;judgement-types&quot;</span>, <span class="string">&quot;testdata&quot;</span>, <span class="string">&quot;problems&quot;</span>,</span><br><span class="line">        <span class="string">&quot;pause&quot;</span>, <span class="string">&quot;team-members&quot;</span>, <span class="string">&quot;map-info&quot;</span>, <span class="string">&quot;start-status&quot;</span>, <span class="string">&quot;commentary&quot;</span> &#125;;</span><br></pre></td></tr></table></figure>
<p>而大写变量就定义在<code>DiskContestSource.java</code>的开头处</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">LOGO</span> <span class="operator">=</span> <span class="string">&quot;logo&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">PHOTO</span> <span class="operator">=</span> <span class="string">&quot;photo&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">VIDEO</span> <span class="operator">=</span> <span class="string">&quot;video&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">BANNER</span> <span class="operator">=</span> <span class="string">&quot;banner&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">BACKUP</span> <span class="operator">=</span> <span class="string">&quot;backup&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">KEY_LOG</span> <span class="operator">=</span> <span class="string">&quot;key_log&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TOOL_DATA</span> <span class="operator">=</span> <span class="string">&quot;tool_data&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FILES</span> <span class="operator">=</span> <span class="string">&quot;files&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">REACTION</span> <span class="operator">=</span> <span class="string">&quot;reaction&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">COUNTRY_FLAG</span> <span class="operator">=</span> <span class="string">&quot;country_flag&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] LOGO_EXTENSIONS = <span class="keyword">new</span> <span class="title class_">String</span>[] &#123; <span class="string">&quot;png&quot;</span>, <span class="string">&quot;svg&quot;</span>, <span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;jpeg&quot;</span> &#125;;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] PHOTO_EXTENSIONS = <span class="keyword">new</span> <span class="title class_">String</span>[] &#123; <span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;jpeg&quot;</span>, <span class="string">&quot;png&quot;</span>, <span class="string">&quot;svg&quot;</span> &#125;;</span><br></pre></td></tr></table></figure>
<hr />
<p>以队伍照片为例，为看清它从哪里读取队伍照片，我们找到这个入口，其代码为</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (type == ContestType.TEAM) &#123;</span><br><span class="line">    <span class="keyword">if</span> (PHOTO.equals(property))</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FilePattern</span>(type, id, property, PHOTO_EXTENSIONS);</span><br></pre></td></tr></table></figure>
<p><code>FilePattern</code>的定义就在该文件的<code>78</code>行。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">FilePattern</span> &#123;</span><br><span class="line">    <span class="comment">// the folder containing the file</span></span><br><span class="line">    <span class="keyword">protected</span> String folder;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// the file name, without extension</span></span><br><span class="line">    <span class="keyword">protected</span> String name; <span class="comment">// e.g. &quot;logo&quot; or &quot;files&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// the file extensions</span></span><br><span class="line">    <span class="keyword">protected</span> String[] extensions; <span class="comment">// e.g. &quot;jpg&quot; or &quot;zip&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// the partial url to access the file</span></span><br><span class="line">    <span class="keyword">protected</span> String url;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">FilePattern</span><span class="params">(IContestObject.ContestType type, String id, String property, String fileExtension)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>(type, id, property, <span class="keyword">new</span> <span class="title class_">String</span>[] &#123; fileExtension &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">FilePattern</span><span class="params">(IContestObject.ContestType type, String id, String property, String[] fileExtensions)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (type == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="built_in">this</span>.folder = <span class="string">&quot;contest&quot;</span>;</span><br><span class="line">            <span class="built_in">this</span>.url = property;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">typeName</span> <span class="operator">=</span> IContestObject.getTypeName(type);</span><br><span class="line">            <span class="built_in">this</span>.folder = typeName + File.separator + id;</span><br><span class="line">            <span class="built_in">this</span>.url = typeName + <span class="string">&quot;/&quot;</span> + id + <span class="string">&quot;/&quot;</span> + property;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">this</span>.name = property;</span><br><span class="line">        <span class="built_in">this</span>.extensions = fileExtensions;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> folder + <span class="string">&quot; &quot;</span> + name + <span class="string">&quot; &quot;</span> + String.join(<span class="string">&quot;,&quot;</span>, extensions) + <span class="string">&quot; &quot;</span> + url;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>从构造函数可以看出，其定义的路径为<code>typeName/id/property</code></p>
<p>再看传入的参数，<code>type</code>为<code>ContestType.TEAM</code>，即<code>teams</code>，<code>id</code>为队伍的<code>icpc id</code>，<code>property</code>为<code>PHOTO</code>即<code>photo</code>，文件后缀名为<code>PHOTO_EXTENSIONS</code>即<code>jpg, jpeg, png, svg</code>都可以。</p>
<p>因此队伍的<code>icpc id</code>为<code>3000</code>的队伍照片应放置于<code>teams/3000/photo.png</code>，相对于<code>CDP</code>根目录，即<code>events.xml</code>所在的目录。</p>
<p>以同样的方式可以得出以下资源的放置路径：</p>
<ul>
<li>队伍录像为<code>teams/3000/video.m2ts</code></li>
<li>队伍备份为<code>teams/3000/backup.zip</code></li>
<li>队伍KEY_LOG为<code>teams/3000/key_log.txt</code></li>
<li>队伍TOOL_DATA为<code>teams/3000/tool_data.txt</code></li>
<li>个人照片为<code>persons/id/photo.png</code>（暂不清楚该<code>id</code>是什么）</li>
<li>组织（ORGANIZATION、Affiliations）logo为<code>organizations/3000/logo.png</code></li>
<li>组织（ORGANIZATION、Affiliations）country_flag为<code>organizations/3000/country_flag.png</code></li>
<li>提交文件为<code>submissions/id/files.zip</code>（暂不清楚该<code>id</code>是什么）</li>
<li>提交的reaction为<code>submissions/id/reaction.m2ts</code>（暂不清楚该<code>id</code>是什么）</li>
<li>组别（group、Categories）的logo为<code>groups/id/logo.png</code>（暂不清楚该<code>id</code>是什么）</li>
<li>比赛的logo为<code>contest/logo.png</code></li>
<li>比赛的banner为<code>contest/banner.png</code></li>
</ul>
<h4 id="读取的yaml"><a class="markdownIt-Anchor" href="#读取的yaml"></a> 读取的yaml</h4>
<p>该文件再往下看，第<code>974</code>行的函数<code>protected void loadConfigFiles() </code>可以看到其读取的<code>yaml</code>文件有</p>
<ul>
<li><code>contest.yaml</code></li>
<li><code>accounts.yaml</code></li>
<li><code>problemset.yaml</code></li>
<li><code>groups.tsv</code></li>
<li><code>institutions.tsv</code></li>
<li><code>teams.tsv</code></li>
<li><code>members.tsv</code></li>
</ul>
<h3 id="resolvertsv"><a class="markdownIt-Anchor" href="#resolvertsv"></a> resolver.tsv</h3>
<p>如果查看<code>resolver</code>的运行日志<code>log</code>的话，会发现一开始<code>resolver</code>似乎在尝试寻找叫<code>resolver.tsv</code>的文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2022.04.30 20:10.03 I Connection failed to resolver.tsv, trying again</span><br><span class="line">java.net.MalformedURLException: no protocol: nullresolver.tsv</span><br><span class="line">	at java.base/java.net.URL.&lt;init&gt;(URL.java:674)</span><br><span class="line">	at java.base/java.net.URL.&lt;init&gt;(URL.java:569)</span><br><span class="line">	at java.base/java.net.URL.&lt;init&gt;(URL.java:516)</span><br><span class="line">	at org.icpc.tools.contest.model.feed.RESTContestSource.createConnection(RESTContestSource.java:223)</span><br><span class="line">	at org.icpc.tools.contest.model.feed.RESTContestSource.downloadIfNecessaryImpl(RESTContestSource.java:316)</span><br><span class="line">	at org.icpc.tools.contest.model.feed.RESTContestSource.downloadIfNecessary(RESTContestSource.java:291)</span><br><span class="line">	at org.icpc.tools.contest.model.feed.RESTContestSource.getFile(RESTContestSource.java:244)</span><br><span class="line">	at org.icpc.tools.resolver.Resolver.loadSteps(Resolver.java:450)</span><br><span class="line">	at org.icpc.tools.resolver.Resolver.main(Resolver.java:199)</span><br><span class="line">2022.04.30 20:10.03 I Connection failed to resolver.tsv again, trying again after 500ms</span><br><span class="line">java.net.MalformedURLException: no protocol: nullresolver.tsv</span><br><span class="line">	at java.base/java.net.URL.&lt;init&gt;(URL.java:674)</span><br><span class="line">	at java.base/java.net.URL.&lt;init&gt;(URL.java:569)</span><br><span class="line">	at java.base/java.net.URL.&lt;init&gt;(URL.java:516)</span><br><span class="line">	at org.icpc.tools.contest.model.feed.RESTContestSource.createConnection(RESTContestSource.java:223)</span><br><span class="line">	at org.icpc.tools.contest.model.feed.RESTContestSource.downloadIfNecessaryImpl(RESTContestSource.java:316)</span><br><span class="line">	at org.icpc.tools.contest.model.feed.RESTContestSource.downloadIfNecessary(RESTContestSource.java:291)</span><br><span class="line">	at org.icpc.tools.contest.model.feed.RESTContestSource.getFile(RESTContestSource.java:244)</span><br><span class="line">	at org.icpc.tools.resolver.Resolver.loadSteps(Resolver.java:450)</span><br><span class="line">	at org.icpc.tools.resolver.Resolver.main(Resolver.java:199)</span><br></pre></td></tr></table></figure>
<p>在源码中搜索该<code>resolver.tsv</code>的话，在<code>Resolver/src/org/icpc/tools/resolver/Resolver.java</code>中的<code>loadSteps</code>函数可以看到其文件输入会被读入到一个叫<code>predeterminedSteps</code>的变量。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> br.readLine();</span><br><span class="line"><span class="keyword">while</span> (s != <span class="literal">null</span>) &#123;</span><br><span class="line">    String[] st = s.split(<span class="string">&quot;\\t&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (st != <span class="literal">null</span> &amp;&amp; st.length &gt; <span class="number">0</span>)</span><br><span class="line">        predeterminedSteps.add(<span class="keyword">new</span> <span class="title class_">PredeterminedStep</span>(st[<span class="number">0</span>], st[<span class="number">1</span>]));</span><br><span class="line"></span><br><span class="line">    s = br.readLine();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>从这里我们可以看到其格式就是一行用<code>\t</code>分隔开的两个数，从<code>PredeterminedStep</code>的构造函数<code>public PredeterminedStep(String teamId, String problemLabel)</code>我们就可以看出来这两个数分别表示<code>teamid</code>和<code>problemLabel</code>。</p>
<p>继续搜索该变量名<code>predeterminedSteps</code>，会在<code>ContestModel/src/org/icpc/tools/contest/model/resolver/ResolverLogic.java</code>的<code>getNextResolve</code>函数看到它起到的作用</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> SubmissionInfo <span class="title function_">getNextResolve</span><span class="params">()</span> &#123;</span><br><span class="line">    ITeam[] teams = contest.getOrderedTeams();</span><br><span class="line">    <span class="type">int</span> <span class="variable">numProblems</span> <span class="operator">=</span> contest.getNumProblems();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> teams.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="type">ITeam</span> <span class="variable">team</span> <span class="operator">=</span> teams[i];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// check for predetermined steps first</span></span><br><span class="line">        <span class="keyword">for</span> (PredeterminedStep ps : predeterminedSteps) &#123;</span><br><span class="line">            <span class="keyword">if</span> (ps.teamId.equals(team.getId())) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">pInd</span> <span class="operator">=</span> contest.getProblemIndexByLabel(ps.problemLabel);</span><br><span class="line">                <span class="keyword">if</span> (pInd &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="type">IResult</span> <span class="variable">r1</span> <span class="operator">=</span> contest.getResult(team, pInd);</span><br><span class="line">                    <span class="keyword">if</span> (r1.getStatus() == Status.SUBMITTED) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">SubmissionInfo</span>(team, pInd);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// otherwise, default to pick left</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; numProblems; j++) &#123;</span><br><span class="line">            <span class="type">IResult</span> <span class="variable">r1</span> <span class="operator">=</span> contest.getResult(team, j);</span><br><span class="line">            <span class="keyword">if</span> (r1.getStatus() == Status.SUBMITTED) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">SubmissionInfo</span>(team, j);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>从该代码的逻辑可以得知，在滚榜、揭晓各队伍提交结果的时候，一般默认是队伍从左到右的题目的提交结果，而我们通过该<code>resolver.tsv</code>就可以自定义揭晓的顺序，而不是默认的从左到右。</p>
<h2 id="结尾"><a class="markdownIt-Anchor" href="#结尾"></a> 结尾</h2>
<p>感谢你能看到最后。相信阅读完这些你会对<code>icpc tools</code>的源码有了进一步的了解。无论是文档是否未跟上，还是文档所引述的标准莫名404了，只要源码是开源的，终有办法摸清其内在的逻辑。无论之后<code>resolver</code>的代码如何变化，本文对阅读其源码，找到自己想要的信息有比较好的指引。</p>
</article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>滚榜程序Resolver源码阅读</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="http://blog.lanly.vip/posts/7b2538bb.html">http://blog.lanly.vip/posts/7b2538bb.html</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>作者</h><div class="post-copyright-cc-info"><h>Lanly</h></div></div><div class="post-copyright-c"><h>发布于</h><div class="post-copyright-cc-info"><h>2022-05-01</h></div></div><div class="post-copyright-u"><h>更新于</h><div class="post-copyright-cc-info"><h>2025-08-19</h></div></div><div class="post-copyright-c"><h>许可协议</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener external nofollow noreferrer" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener external nofollow noreferrer" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ICPC-tools/">ICPC_tools</a><a class="post-meta__tags" href="/tags/resolver/">resolver</a><a class="post-meta__tags" href="/tags/%E6%BB%9A%E6%A6%9C/">滚榜</a></div><div class="post_share"><div class="social-share" data-image="/img/chino/vec/chino4.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#cdp%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.</span> <span class="toc-text"> CDP格式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB"><span class="toc-number">2.</span> <span class="toc-text"> 源码阅读</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%AE%E5%8A%A9"><span class="toc-number">2.1.</span> <span class="toc-text"> 帮助</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xml%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96"><span class="toc-number">2.2.</span> <span class="toc-text"> xml文件读取</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#contest-info"><span class="toc-number">2.2.1.</span> <span class="toc-text"> contest INFO</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#problem"><span class="toc-number">2.2.2.</span> <span class="toc-text"> Problem</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#regision"><span class="toc-number">2.2.3.</span> <span class="toc-text"> regision</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#team"><span class="toc-number">2.2.4.</span> <span class="toc-text"> team</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#judgement"><span class="toc-number">2.2.5.</span> <span class="toc-text"> judgement</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#run"><span class="toc-number">2.2.6.</span> <span class="toc-text"> run</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#award"><span class="toc-number">2.2.7.</span> <span class="toc-text"> award</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#finalized"><span class="toc-number">2.2.8.</span> <span class="toc-text"> finalized</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E5%AD%97%E6%AE%B5"><span class="toc-number">2.2.9.</span> <span class="toc-text"> 其他字段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#testcase"><span class="toc-number">2.2.10.</span> <span class="toc-text"> testcase</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#clar"><span class="toc-number">2.2.11.</span> <span class="toc-text"> clar</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%A5%96%E7%B1%BB%E5%9E%8B"><span class="toc-number">2.3.</span> <span class="toc-text"> 获奖类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#yaml%E6%96%87%E4%BB%B6"><span class="toc-number">2.4.</span> <span class="toc-text"> yaml文件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#contestyaml"><span class="toc-number">2.4.1.</span> <span class="toc-text"> contest.yaml</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#problemsetyaml"><span class="toc-number">2.4.2.</span> <span class="toc-text"> problemset.yaml</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B5%84%E6%BA%90%E8%B7%AF%E5%BE%84"><span class="toc-number">2.5.</span> <span class="toc-text"> 资源路径</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E7%9A%84yaml"><span class="toc-number">2.5.1.</span> <span class="toc-text"> 读取的yaml</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#resolvertsv"><span class="toc-number">2.6.</span> <span class="toc-text"> resolver.tsv</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E5%B0%BE"><span class="toc-number">3.</span> <span class="toc-text"> 结尾</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2025 By Lanly</div><div class="framework-info"><span>框架 </span><a href="https://hexo.io" rel="external nofollow noreferrer">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" rel="external nofollow noreferrer">Butterfly</a></div><div class="footer_custom_text"><a href="https://beian.miit.gov.cn/" rel="external nofollow noreferrer" target="_blank">粤ICP备2021014426</a></div><script type="text/javascript" id="maid-script" src="https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js?v=undefined"></script><script>if (window.mermaid) {
  var options = JSON.parse(document.getElementById('maid-script').getAttribute('mermaidoptioins'));
  mermaid.initialize(options);
}</script></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    btf.addModeChange('mermaid', () => {
      window.runMermaid()
    })

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><script defer src="/js/light.js"></script><script defer src="/js/universe.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer src="/js/homeessay.js"></script><canvas id="universe"></canvas><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('bbTimeList');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/10a3c0f3.html&quot;);" href="javascript:void(0);" rel="external nofollow noreferrer" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/chino/vec/chino58.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-06-06</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/10a3c0f3.html&quot;);" href="javascript:void(0);" rel="external nofollow noreferrer" alt="">Webots——Fianl大作业</a><div class="blog-slider__text">小组合作作业</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/10a3c0f3.html&quot;);" href="javascript:void(0);" rel="external nofollow noreferrer" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/7b2538bb.html&quot;);" href="javascript:void(0);" rel="external nofollow noreferrer" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/chino/vec/chino4.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-05-01</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/7b2538bb.html&quot;);" href="javascript:void(0);" rel="external nofollow noreferrer" alt="">滚榜程序Resolver源码阅读</a><div class="blog-slider__text">太难了.jpg</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/7b2538bb.html&quot;);" href="javascript:void(0);" rel="external nofollow noreferrer" alt="">详情       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('已挂载butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterend",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><!-- hexo injector body_end end --></body></html>